索引是帮助MySQL高效获取数据的数据结构，索引是数据结构。


索引对查找和排序都会有影响。


我们平时所说的索引，如果没有特别的指明，都是 指B树（多路搜索树，并不一定是二叉树）结构组织的索引。其中聚集索引，次要索引，覆盖索引，复合索引，前缀索引，唯一索引默认都是B+树索引，统称索引。除了B+树这种类型的索引之外，还有哈希索引（hash index）等。


# 优势
提高数据检索的效率，降低数据库的IO成本。
通过索引列对数据进行排序，降低了数据的排序成本，降低了CPU的消耗。


# 劣势
实际上索引也是一张表，保存了主键与索引字段，并指向实体表的记录，所以索引也是要占用空间的，以文件的形式保存在磁盘上。

虽然索引大大提高了查询的速度，同时却会降低更新表的速度，如对表进行update、insert、delete。因为表更新时，MySQL不仅要保存数据，还要保存索引文件每次更新添加了索引列的字段，都会调整因为更新所带来的键值变化后的索引信息。

索引只是提高效率的一种因素，如果MySQL有大量的数据表，就需要花时间研究简历最优秀的索引，或者优化查询语句。


# 单值索引
一个索引只包含单个列，一个表可以有多个单列索引。


# 唯一索引
索引列的值必须唯一，但允许有空。


# 复合索引
一个索引包含多个列


# 创建索引


方式一：
**CREATE **[UNIQUE] **INDEX **indexName **ON **tableName(cloumnName(length))


方式二：
**alter **tableName **add **[UNIQUE] **index **[indexName] **on**（columnName(length))


# 删除索引


**drop index **[indexName] **on **tableName 


# 查看索引


**show index from **tableName


# 索引结构


## BTrre索引
MySQL 索引采用B+树的数据结构进行存储

真实的数据存在于叶子节点，即3、5、9、10、13、15、28、29、36、60、75、79、90、99.


非叶子节点不存储真实数据，只存储指引搜索方向的数据项（指针），如17、35并不真实存在于数据表中。


一个磁盘相当于一个数据页，B+树的查找过程如下：

![](https://cdn.nlark.com/yuque/0/2021/png/12409267/1616750780934-046269d5-cf63-4137-9071-8ddfdae2d6db.png#align=left&display=inline&height=296&margin=%5Bobject%20Object%5D&originHeight=296&originWidth=618&size=0&status=done&style=none&width=618)


比如要查找数据项29:


        首先会把磁盘块1加载到内存中，此时发生一次IO，在内存中用二分法查找 确定29在17 和35之间，锁定磁盘块1的P2指针，内存处理时间相对比磁盘IO非常短，可以忽略不计。


        然后通过磁盘块1中的P2指针指向的地址把磁盘块3加载到内存中，此时发生第二次IO，采用二分法确定29在26和30之间，锁定磁盘块3中的P2指针。


        最后通过磁盘块3中P2 指针指向的地址把磁盘块8加载到内存中，此时发生第三次IO，采用二分法查找到29，查询结束，共进行三次IO。


        真实情况是，3层的B+树可以表示上百万的数据，如果上百万的数据查询只需要三次IO，性能提高将是巨大的，如果没有索引，每个数据项都要发生一次IO，那么总共需要百万次的IO，显然成本是非常高的。










































